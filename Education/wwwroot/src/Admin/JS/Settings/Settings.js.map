{"version":3,"file":"Settings.js","sourceRoot":"","sources":["Settings.ts"],"names":[],"mappings":"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","sourcesContent":["import \"../../../global/helperDome\";\r\n$(function() {\r\n  ImagesSettingOperaions.main();\r\n  MembershipSettingOperations.main();\r\n});\r\ninterface MembershipModel {\r\n  name: string;\r\n  title: string;\r\n}\r\nlet ImagesSettingOperaions = {\r\n  ImgsDataUrl: \"/Admin/Settings/ListBgImages\",\r\n  DeleteImagesUrl: \"/Admin/Settings/DeleteImage\",\r\n  BaseImgSrc: \"/images/Student/backgrounds/\",\r\n  ImagesData: [] as string[],\r\n  BgImages: $(\"#BgImages img\"),\r\n  AddImgBtn: $(\"#AddNewBgImg\"),\r\n  DeleteImgBtn: $(\"#DeleteBgImg\"),\r\n  handleImgSelectable() {\r\n    $(document.body).on(\"click\", \"#BgImages img\", e => {\r\n      $(e.target).toggleClass(\"selected\");\r\n    });\r\n  },\r\n  async GetImagesData() {\r\n    return $.get(this.ImgsDataUrl).done(data => {\r\n      this.ImagesData = JSON.parse(data);\r\n    });\r\n  },\r\n  CreateImages() {\r\n    let container = $();\r\n    for (let imgName of this.ImagesData) {\r\n      let thumbnailImg = $(`\r\n        <div class=\"col-md-4 imgCard\">\r\n            <img class=\"img-responsive img-thumbnail\" src=\"${\r\n              this.BaseImgSrc\r\n            }${imgName}\">\r\n        </div>\r\n        `);\r\n      thumbnailImg.find(\"img\").data(\"name\", imgName);\r\n      container = container.add(thumbnailImg);\r\n    }\r\n    $(\"#BgImages .images\").append(container);\r\n  },\r\n  CreateNewImage(imgName: string) {\r\n    let imgSrc = `${this.BaseImgSrc}${imgName}`;\r\n    let thumbnailImg = $(`\r\n        <div class=\"col-md-4\">\r\n            <img class=\"img-responsive img-thumbnail\" src=\"${imgSrc}\">\r\n        </div>\r\n    `);\r\n    thumbnailImg.find(\"img\").data(\"name\", imgName);\r\n    $(\"#BgImages .images\").append(thumbnailImg);\r\n  },\r\n  HandleAddNewImage() {\r\n    let input = $(\r\n      `<input type='file' accept='image/*' id='uploadImg' class=\"hidden\"/>`\r\n    );\r\n    $(document.body).append(input);\r\n    this.AddImgBtn.click(e => {\r\n      input.click();\r\n    });\r\n    input.change(e => {\r\n      let file = ((<HTMLInputElement>e.target).files as FileList)[0];\r\n      let extension = \".\" + file.name.split(\".\").pop();\r\n      let Name = `${Date.now()}${extension}`;\r\n      if (file.type.indexOf(\"image\") == -1) {\r\n        $.notify({\r\n          message: \"هذة النوعية من الصور غير مدعومة\"\r\n        });\r\n        return;\r\n      }\r\n      this.ImagesData.push(Name);\r\n      let formData = new FormData();\r\n      formData.append(\"Name\", Name);\r\n      formData.append(\"Value\", JSON.stringify(this.ImagesData));\r\n      formData.append(\"Image\", file);\r\n      this.AddImgBtn.pendingState(true, \"fa-picture-o\");\r\n      $.ajax({\r\n        url: \"/Admin/Settings/SaveImage\",\r\n        data: formData,\r\n        method: \"POST\",\r\n        processData: false,\r\n        cache: false,\r\n        contentType: false\r\n      })\r\n        .done(() => {\r\n          $.notify({\r\n            message: \"تم حفظ الصورة بنجاح\"\r\n          });\r\n          this.CreateNewImage(Name);\r\n        })\r\n        .always(() => {\r\n          this.AddImgBtn.pendingState(false);\r\n        })\r\n        .catch(e => {\r\n          $.notify({\r\n            message: \"لم يتم حفظ الصورة,حدثت مشكلة فى السيرفر\"\r\n          });\r\n          this.ImagesData.pop();\r\n        });\r\n    });\r\n  },\r\n  HandleDeleteImage() {\r\n    this.DeleteImgBtn.click(e => {\r\n      let imgsName: string[] = [];\r\n      let imgs = $(\"#BgImages img.selected\");\r\n      for (let i = 0; i < imgs.length; i++) {\r\n        imgsName.push(imgs.eq(i).data(\"name\"));\r\n      }\r\n      let oldImagesData = this.ImagesData;\r\n      this.ImagesData = this.ImagesData.filter(name => {\r\n        if (imgsName.indexOf(name) == -1) return name;\r\n      });\r\n      this.DeleteImgBtn.pendingState(true, \"fa-remove\");\r\n      $.post(this.DeleteImagesUrl, {\r\n        imgsName: imgsName,\r\n        value: JSON.stringify(this.ImagesData)\r\n      })\r\n        .always(() => {\r\n          this.DeleteImgBtn.pendingState(false);\r\n        })\r\n        .done(() => {\r\n          $.notify({\r\n            message: \"تمت عملية الحذف بنجاح\"\r\n          });\r\n          imgs.fadeOut();\r\n        })\r\n        .catch(e => {\r\n          $.notify({\r\n            message: \"لم يتم حذف الصورة,حدثت مشكلة فى السيرفر\"\r\n          });\r\n          this.ImagesData = oldImagesData;\r\n        });\r\n    });\r\n  },\r\n  main() {\r\n    this.handleImgSelectable();\r\n    this.GetImagesData().then(d => {\r\n      $(\".loading\").hide();\r\n      this.CreateImages();\r\n      this.HandleAddNewImage();\r\n      this.HandleDeleteImage();\r\n    });\r\n  }\r\n};\r\nlet MembershipSettingOperations = {\r\n  FetchMembershipDataUrl: \"/Admin/Settings/GetMembership\",\r\n  SaveMembershipDataUrl: \"/Admin/Settings/SaveMembership\",\r\n  Form: $(\"#MembershipForm\"),\r\n  get NameInp() {\r\n    return this.Form.find(\"#Name\");\r\n  },\r\n  get TitleInp() {\r\n    return this.Form.find(\"#Title\");\r\n  },\r\n  SaveBtn: $(\"#SaveBtn\"),\r\n  FetchMembershipData() {\r\n    $.get(this.FetchMembershipDataUrl).done((data: MembershipModel) => {\r\n      this.NameInp.val(data.name);\r\n      this.TitleInp.val(data.title);\r\n    });\r\n  },\r\n  GetFormEditedData(): MembershipModel {\r\n    return {\r\n      name: this.NameInp.val() as string,\r\n      title: this.TitleInp.val() as string\r\n    };\r\n  },\r\n  HandleOnFormSubmit() {\r\n    this.SaveBtn.click(e => {\r\n      if (this.Form.valid()) {\r\n        let data = this.GetFormEditedData();\r\n        this.SaveBtn.pendingState(true, \"fa-send\");\r\n        $.post(this.SaveMembershipDataUrl, {\r\n          Name: data.name,\r\n          Title: data.title\r\n        })\r\n          .done(() => {\r\n            $.notify({\r\n              message: \"تم تعديل بيانات العضوية بنجاح\"\r\n            });\r\n          })\r\n          .always(() => {\r\n            this.SaveBtn.pendingState(false);\r\n          })\r\n          .catch(e => {\r\n            let message =\r\n              e.responseJSON && e.responseJSON.message\r\n                ? e.responseJSON.message\r\n                : \"لا يمكن تنفيذ العملية الان,لحدوث مشكلة عند الخادم\";\r\n            $.notify({\r\n              message: message,\r\n              title: \"لم يتم تنفيذ العملية\"\r\n            });\r\n          });\r\n      }\r\n    });\r\n  },\r\n  main() {\r\n    this.FetchMembershipData();\r\n    this.HandleOnFormSubmit();\r\n  }\r\n};\r\n"]}